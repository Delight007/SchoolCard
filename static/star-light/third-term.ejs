<html lang="en">
  <head>
    <title><%= data.student.name %> Report Card</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      rel="preload"
      href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&display=swap"
      as="style"
      onload="this.onload=null;this.rel='stylesheet'"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&display=swap"
      rel="stylesheet"
    />

    <style>
      @page {
      size: A4;
      margin: 0;
    }
    
    
      td,
      th {
        border: 2px solid #a37396;
      }

      th, td {
      padding: 3px;
      text-align: center;
      
    }


      body {
        margin: 0;
        font-family: 'Roboto', sans-serif;
        color: #a37396;
      }

      .container {
        /* border: 2px solid red; */
        padding: 30px;
        margin: 4px;

      }

      .report-card {
        /*border: 2px solid rgb(165, 117, 48);*/
      }

      table {
        width: 100%;
        border-collapse: collapse;
        table-layout: fixed;
      }

      th,
      td {
        padding: 4px;
        font-size: 0.9em;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="report-card">
        <div style="display: flex; justify-content: space-between; gap: 20px">
         
          <div style="border: 1px solid #a37396; width: 200px; height: 200px">
            <img
              src="<%= data.school.logo %>"
              alt="Logo"
              height="200"
              width="200"
              style="object-fit: contain"
            />
          </div>
          <div style="display: flex; justify-content: center; align-items: center; flex-direction: column">
           
            <h1 style="color: #a37396; font-size: 35px; margin: 0;">
              <%= data.school.name?.toUpperCase() %>
            </h1>
            
            <!-- <h2 style="font-size: 20px; margin: 0; word-spacing: 7px;">
              Creche, Nursery, Primary & Secondary
            </h2>
            -->
              <h4
              style="
                margin: 0;
                font-size: 18px;
                color: #a37396;
                font-weight: 400;
                margin-top: 5px;
                text-transform: uppercase;
                font-weight: 700;
              "
            >
              <%= data.school.address %>
            </h4>
            <!-- <h5 style="margin-top: 10px; margin-bottom: 0; font-size: 16px; color: rgb(51, 71, 75)">
             Tel: 09080113634, 08027983689
            </h5> -->
         
           <!-- <div style="margin-top: 5px; display: flex; justify-content: center; align-items: center; gap:6px; border: 1px solid #dd816a;">
            <span style="background-color: #dd816a; padding-left:6px; padding-right: 7px; padding-top:2px; padding-bottom: 2px; margin: 0; font-size: 14px; text-align: center; color: white;">Motto: </span>
           <span style="font-size: 14px; font-weight: 700; word-spacing: 5px; padding:0 4px 0 4px; "> <%= data.school.motto %></span>
           </div> -->
           
             <h1
            style="
              font-size: 24px;
              margin: 0;
              font-weight:700;
              padding: 8px;
              color: #a37396;
              width: fit-content;
              margin-top: 6px;
              letter-spacing: 2px;
              font-family:cursive;
              text-decoration: underline;
            "
           >
            PRIMARY SECTION
           </h1>
          
            
          </div>
          <div
            style="
              position: relative;
              border: 1px solid #a37396;
              width: 200px;
              height: 200px;
              display: flex;
              align-items: center;
              justify-content: center;
            "
          >
            <% if (data.student.passport) { %>
            <img
              src="<%= data.student.passport %>"
              alt="Passport"
              height="200"
              width="200"
              style="object-fit: contain"
            />
            <% } else { %>
            <div
              style="
                position: absolute;
                color: #a37396;
                font-weight: bold;
                font-size: 20px;
                transform: rotate(-45deg);
                opacity: 0.5;
                text-align: center;
              "
            >
              Passport
            </div>
            <% } %>
          </div>
        </div>
        <div style="margin-top: 10px; display: flex; justify-content: center; align-items: center;">
          <div style="display: flex; align-items: flex-end; gap: 4px; width: 20%; margin-left: 450px;">
            <p style="margin: 0; font-size: 14px; line-height: 14px; font-weight: 700">TERM:</p>
            <div
              style="flex: 1; border-bottom: 1px solid #a37396; font-size: 16px; font-weight: 400"
            >
              <%= data.termName %>
            </div>
          </div>
        </div>
       
        <div style="display: flex; gap: 1%;">
          <!-- student details -->
          <div style="margin-top: 10px; display: flex; flex-direction: column; gap: 10px; width: 75%; border: 2px solid #a37396; padding: 6px;">       
            <div style="display: flex; justify-content: space-between; align-items: center; gap: 2%; width: 100%;">
              <div style="display: flex; width: 49%; gap: 4px">
                <p style="margin: 0; font-size: 14px;  font-weight: 700">
                PUPIL'S NAME :
                </p>
                <div
                  class="student-name"
                  style="
                    border-bottom: 1px solid #a37396;
                    font-size: 14px;
                    font-weight: 400;
                   flex: 1;
                  "
                >
                  <%= data.student.name %>
                </div>
              </div>
              <div style="display: flex; gap: 4px; width: 49%">
                <p style="margin: 0; font-size: 14px; font-weight: 700">ADMISSION NUMBER-VCLEF:</p>
                <div
                  style="flex: 1; border-bottom: 1px solid #a37396; font-size: 14px; font-weight: 400"
                >
                  <%= data.student.admissionNo %>
                </div>
              </div>
            
            </div>
            <div style="display: flex; justify-content: space-between; gap: 2%; width: 100%; margin-top: 5px;">
              <div style="display: flex;  gap: 4px; width: 49%; align-items: center;">
                <p style="margin: 0; font-size: 14px;  font-weight: 700">
                 POST HELD :
                </p>
                <div
                  style="flex: 1; border-bottom: 1px solid #a37396; font-size: 14px; font-weight: 400"
                >
                  <%= data.student.postHeld %>
                </div>
              </div>
              <div style="display: flex; gap: 4px; width: 49%">
                <p style="margin: 0; font-size: 14px; font-weight: 700">
                NO OF TIMES SCHOOL OPENED:
                </p>
                <div
                  style="flex: 1; border-bottom: 1px solid #a37396; font-size: 14px; font-weight: 400"
                >
                  <%= data.numberOfDaysOpened %>
                </div>
              </div>
              
            </div>
            <div style="display: flex; justify-content: space-between; gap: 2%; width: 100%; margin-top: 5px;">
               <div style="display: flex;  width: 50%; gap: 4px">
              <p style="margin: 0; font-size: 14px;  font-weight: 700">
              SCHOOL OPENED:
              </p>
              <div
                class="student-name"
                style="
                  flex: 1;
                  border-bottom: 1px solid #a37396;
                  font-size: 14px;
                  font-weight: 400;
                  padding-left: 5px;
                "
              >
                <%= data.termStartOn %>
              </div>
             </div>
              <div style="display: flex;  gap: 4px; width: 50%">
                <p style="margin: 0; font-size: 14px;font-weight: 700">
               NO OF ATTENDANCE:
                </p>
                <div style="flex: 1; font-size: 14px; border-bottom: 1px solid #a37396">
                  <%= data.presentCount %>
                </div>
              </div>
            </div>
            <div style="display: flex; justify-content: space-between; gap: 2%; width: 100%; margin-top: 5px;">
              <div style="display: flex;  width: 50%; gap: 4px">
             <p style="margin: 0; font-size: 14px; font-weight: 700">
             POSITION:
             </p>
             <div
               class="student-name"
               style="
                 flex: 1;
                 border-bottom: 1px solid #a37396;
                 font-size: 14px;
                 font-weight: 400;
                 padding-left: 5px;
               "
             >
               <%= data.student.position %>
             </div>
            </div>
             <div style="display: flex; gap: 4px; width: 50%">
               <p style="margin: 0; font-size: 14px;font-weight: 700">
              NO IN CLASS:
               </p>
               <div style="flex: 1; font-size: 14px; border-bottom: 1px solid #a37396">
                 <%= data.numberInClass%>
               </div>
             </div>
           </div>
           <div style="display: flex; justify-content: space-between; gap: 2%; width: 100%; margin-top: 5px;">
            <div style="display: flex;  width: 50%; gap: 4px">
           <p style="margin: 0; font-size: 14px; font-weight: 700">
           GENDER:
           </p>
           <div
             class="student-name"
             style="
               flex: 1;
               border-bottom: 1px solid #a37396;
               font-size: 14px;
               font-weight: 400;
               padding-left: 5px;
             "
           >
             <%= data.student.gender %>
           </div>
          </div>
           <div style="display: flex;  gap: 4px; width: 50%">
             <p style="margin: 0; font-size: 14px; font-weight: 700">
            NEXT TERM BEGINS:
             </p>
             <div style="flex: 1; font-size: 14px; border-bottom: 1px solid #a37396">
               <%= data.nextTermBegin%>
             </div>
           </div>
            </div>
           <div style="display: flex; justify-content: space-between; gap: 2%; width: 100%; margin-top: 5px;">
          <div style="display: flex; width: 50%; gap: 4px">
         <p style="margin: 0; font-size: 14px;  font-weight: 700">
         CLASS:
         </p>
         <div
           class="student-name"
           style="
             flex: 1;
             border-bottom: 1px solid #a37396;
             font-size: 14px;
             font-weight: 400;
             padding-left: 5px;
           "
         >
           <%= data.className %>
         </div>
        </div>
         <div style="display: flex;  gap: 4px; width: 50%">
           <p style="margin: 0; font-size: 14px;  font-weight: 700">
          DATE OF BIRTH:
           </p>
           <div style="flex: 1; font-size: 14px; border-bottom: 1px solid #a37396">
             <%= data.student.dob %>
           </div>
         </div>
           </div>
           
          </div>
          <div style="margin-top: 10px; width: 24%; display: flex; flex-direction: column; align-items: center;">
            <table
            style="
              border: 2px solid #a37396;
              width: 100%;
              table-layout: fixed;
              border-collapse: collapse;
            "
          >
            
            <tbody>
              <% data.grades.forEach(function(grade, index) { %>
              <tr>
                <td style="font-size: 14px; border: 2px solid #a37396; padding: 7px">
                  <%= grade.label %> = <%= grade.description %>
                </td>
                <td style="font-size: 14px; border: 2px solid #a37396; padding: 7px">
                  <%= Number(grade.min) %> - <%= Number(grade.max) %>
                </td>
              </tr>
              <% }); %>
            </tbody>
          </table>
             </div>
        </div>

        <div style="margin-top: 30px">
          <table
          style="
            border: 1px solid #a37396;
            width: 100%;
            table-layout: fixed;
            border-collapse: collapse;
          "
        >
          <thead>
            <tr>
              <th rowspan="2" style="width: 20%; font-size: 14px; padding: 5px; font-weight: 700">
                SUBJECTS
              </th>
              <th colspan="3" style="font-size: 14px">THIRD TERM</th>
              <th rowspan="2" style="font-size: 14px">SECOND TERM B/F 100%</th>
              <th rowspan="2" style="font-size: 14px">FIRST TERM B/F 100%</th>
              <th rowspan="2" style="font-size: 14px">OVERALL TOTAL</th>
              <th rowspan="2" style="font-size: 14px">GRADE</th>
              <th rowspan="2" style="font-size: 14px">SELECT POSITION</th>
              <th rowspan="2" style="font-size: 14px">TEACHER'S REMARK</th>
            </tr>
            <tr>
              <th scope="col" style="font-size: 14px"> TERM WORK 40%</th>
              <th scope="col" style="font-size: 14px">EXAM MARK 60%</th>
              <th scope="col" style="font-size: 14px">TOTAL SCORE 100%</th>
            </tr>
          </thead>
          <tbody>
            <% data.subjects.forEach(function({
              subjectName,
              subjectId,
              id1,
              id2,
              exam,
              total,
              averageScore,
              grade,
              comment,
              sign,
              assessments
            }) { %>
            <% const subject = data.annualRecord.subjects.find(subj => subj.subjectId === subjectId); %>
            <tr>
              <td style="font-size: 14px; padding: 5px; text-align: left;font-weight:700;"><%= subjectName %></td>
              <td style="font-size: 14px; padding-left: 5px">
                <%= assessments ? Number(assessments[0]) + Number(assessments[1]) : '' %>
              </td>
              <td style="font-size: 14px; padding-left: 5px">
                <%= assessments ? assessments[2] : '' %>
              </td>
              <td style="font-size: 14px; padding-left: 5px; font-weight: bold;"><%= total %></td>
              <td style="font-size: 14px; padding-left: 5px">
                <%= subject ? subject.secondTermTotal : '' %>
              </td>
              <td style="font-size: 14px; padding-left: 5px">
                <%= subject ? subject.firstTermTotal : '' %>
              </td>
              <td style="font-size: 14px; padding-left: 5px; font-weight: bold;">
                <%= subject ? subject.overAllTotal : '' %>
              </td>
              <td style="font-size: 14px; padding-left: 5px; font-weight: bold;">
                <%= grade ? grade?.label : "" %>
              </td>
              <td style="font-size: 14px; padding-left: 5px">
                <%= subject?.position || '' %>
              </td> <!-- Added position value -->
              <td style="font-size: 14px; padding-left: 5px">
                <%= grade ? grade?.description : "" %>
              </td>
            </tr>
            <% }); %>
          </tbody>
        </table> 
        </div>

        <!-- student marks -->
        <div style="display: flex; gap: 10px; margin-top: 10px;">
          <div
          style="
            display: flex;
            font-size: 14px;
            align-items: flex-end;
            gap: 4px;
            width: 70% ;
          "
        >
          <p style="margin: 0; font-weight: 400">Total Scored:</p>
          <div style="border-bottom: 1px solid #a37396; flex: 1"><%= data.markObtained %></div>
        </div>
        <div
          style="
            display: flex;
            font-size: 14px;
            align-items: flex-end;
            gap: 4px;
        
            width: 30% ;
          "
        >
          <p style="margin: 0; font-weight: 400">Out of:</p>
          <div style="border-bottom: 1px solid #a37396; flex: 1"><%= data.markObtainable %></div>
        </div>
        </div>

        
         <div style="margin-top: 30px; color: #a37396;">
            
        <!-- PRACTICAL SKILLS TABLE -->
<div style="width: 100%; margin-bottom: 20px">
  <table
    style="
      border: 2px solid #a37396;
      width: 100%;
      table-layout: fixed;
      border-collapse: collapse;
    "
  >
    <thead>
      <tr>
        <th
          colspan="<%= data.practical_skills.length + 1 %>"
          style="
            text-align: center;
            font-size: 14px;
            font-weight: 700;
            color: #a37396;
            padding: 6px;
            border: 2px solid #a37396;
          "
        >
         EFFECTIVE ASSESSMENT
        </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td
          style="
            font-weight: 700;
            font-size: 14px;
            border: 2px solid #a37396;
            padding: 5px;
            text-align: center;
           
          "
        >
          TRAITS
        </td>
        <% data.practical_skills.forEach(function(trait) { %>
          <td
            style="
              font-size: 12px;
              border: 2px solid #a37396;
              padding: 5px;
              text-align: center;
            "
          >
            <%= trait.name %>
          </td>
        <% }); %>
      </tr>
      <tr>
        <td
          style="
            font-weight: 700;
            font-size: 14px;
            border: 2px solid #a37396;
            padding: 5px;
            text-align: center;
           
          "
        >
          RATING
        </td>
        <% data.practical_skills.forEach(function(trait) { %>
          <td
            style="
              font-size: 12px;
              border: 2px solid #a37396;
              padding: 5px;
              text-align: center;
            "
          >
            <%= trait.value %>
          </td>
        <% }); %>
      </tr>
    </tbody>
  </table>
</div>


<div style="width: 100%; display: flex; gap: 2%;">
  <table
    style="
      border: 2px solid #a37396;
      width: 70%;
      table-layout: fixed;
      border-collapse: collapse;
    "
  >
    <thead>
      <tr>
        <th
          colspan="<%= data.character_development.length + 1 %>"
          style="
            text-align: center;
            font-size: 14px;
            font-weight: 700;
            color: #a37396;
            padding: 6px;
            border: 2px solid #a37396;
          "
        >
          PSYCHOMOTOR ASSESSMENT
        </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td
          style="
            font-weight: 700;
            font-size: 14px;
            border: 2px solid #a37396;
            padding: 5px;
            text-align: center;
           
          "
        >
          ABILITY
        </td>
        <% data.character_development.forEach(function(trait) { %>
          <td
            style="
              font-size: 12px;
              border: 2px solid #a37396;
              padding: 5px;
              text-align: center;
            "
          >
            <%= trait.name %>
          </td>
        <% }); %>
      </tr>
      <tr>
        <td
          style="
            font-weight: 700;
            font-size: 14px;
            border: 2px solid #a37396;
            padding: 5px;
            text-align: center;
           
          "
        >
          RATING
        </td>
        <% data.character_development.forEach(function(trait) { %>
          <td
            style="
              font-size: 12px;
              border: 2px solid #a37396;
              padding: 5px;
              text-align: center;
            "
          >
            <%= trait.value %>
          </td>
        <% }); %>
      </tr>
    </tbody>
  </table>
  <div style="width: 28%; color: #a37396;">
    <span style="font-weight: 600; font-size: 14px;">KEY TO RATING</span> <p style="font-size: 12px;"> 5 - Excellent 4 - Very Good 3 - Good 2 - Fair 1 - Poor</p>
  </div>
</div>

<!-- <div style="margin-top: 10px; width: 100%; display: flex; flex-direction: column; align-items: center;">
  <table
  style="
    border: 2px solid #a37396;
    width: 100%;
    table-layout: fixed;
    border-collapse: collapse;
  "
>
  
  <tbody>
    <% data.grades.forEach(function(grade, index) { %>
    <tr>
      <td style="font-size: 14px; border: 2px solid #a37396; padding: 5px">
        <%= grade.label %> = <%= grade.description %>
      </td>
      <td style="font-size: 14px; border: 2px solid #a37396; padding: 5px">
        <%= Number(grade.min) %> - <%= Number(grade.max) %>
      </td>
    </tr>
    <% }); %>
  </tbody>
</table>
   </div> -->

          
         </div>

        <!-- teacher/ headteacher remark -->
        <div style=" width: 99%; margin-top: 30px; border: 2px solid #a37396; padding: 6px;">
         <div style="display: flex; gap: 10px; ">
          <div
          style="
            display: flex;
            align-items: flex-end;
            gap: 4px;
            margin-top: 20px;
            font-size: 14px;
            width: 70%;
          "
        >
          <p style="margin: 0; font-weight: bold;">Class Teacher's Remark:</p>
          <div style="border-bottom: 1px solid #a37396; flex: 1">
            <%= data.classTeacherRemark %>
          </div>
          
        </div>
        <div
          style="
            display: flex;
            font-size: 14px;
            align-items: flex-end;
            gap: 4px;
            margin-top: 20px;
            width: 30% ;
          "
        >
          <p style="margin: 0; font-weight: bold;">Sign:</p>
          <div style="border-bottom: 1px solid #a37396; flex: 1"><%= data.classTeacherSignature %></div>
        </div>
         </div>
          <div style="display: flex; gap: 10px;">
            <div
            style="
              display: flex;
              font-size: 14px;
              align-items: flex-end;
              gap: 4px;
              margin-top: 20px;
              width: 70% ;
            "
          >
            <p style="margin: 0; font-weight: bold;">Head Teacher's Comment:</p>
            <div style="border-bottom: 1px solid #a37396; flex: 1"><%= data.principalRemark %></div>
          </div>
          <div
            style="
              display: flex;
              font-size: 14px;
              align-items: flex-end;
              gap: 4px;
              margin-top: 20px;
              width: 30% ;
            "
          >
            <p style="margin: 0; font-weight: bold;">Sign:</p>
            <div style="border-bottom: 1px solid #a37396; flex: 1"><%= data.principalSignature %></div>
          </div>
          </div>
        </div>
        <!-- <div
        style="
          display: flex;
          font-size: 14px;
          align-items: flex-end;
          gap: 4px;
          margin-top: 20px;
          width: 100% ;
        "
      >
        <p style="margin: 0; font-weight: 400">Passed/Failed/Promoted/Repeated:</p>
        <div style="border-bottom: 1px solid #a37396; flex: 1"><%= data.nextTermFee %></div>
      </div> -->
        <!-- <div style="margin-top: 1px; display: flex; gap: 20px">
          <div
            style="
              display: flex;
              font-size: 14px;
              align-items: flex-end;
              gap: 4px;
              margin-top: 20px;
              width: 70% ;
            "
          >
            <p style="margin: 0; font-weight: 400">Fee owned for the term N:</p>
            <div style="border-bottom: 1px solid #a37396; flex: 1"><%= data.ownedFee %></div>
          </div> -->
          <!-- <div
            style="
              display: flex;
              font-size: 14px;
              align-items: flex-end;
              gap: 4px;
              margin-top: 20px;
              width: 30% ;
            "
          >
            <p style="margin: 0; font-weight: 400">Fee for Next Term N:</p>
            <div style="border-bottom: 1px solid #a37396; flex: 1"><%= data.nextTermFee %></div>
          </div>
          -->
        </div>
      </div>
      <div style="width: 3000px; height: 1px"></div>
    </div>
  </body>
</html>
